//This script is for use in quickly calculating a MELEE fumble result in the Hackmaster RPG system.

//This script is best triggered by a macro setup like the one on the following line

//!MelFumb ?{Enter the number you missed the target by}

//The macro only asks for one value, making it super easy. If you wanted you could also activate the script by entering, "!MelFumb #" into the chat.

//The script rolls a d1000 and adds the value entered with the macro * 10 to determine the fumble result, just as if you'd rolled a real die.

//There's a few variables used to keep track of penalties and penalty durations for sprains, pulls, muscle tears, etc. They are also used for penetrating dice.

//If all goes well, the script will even return multiple results for the rare terrible fumble result of above 1100!

//In some cases the script will get too many repeating results above 1100, resulting in an near infinite loop. To control for this, the script will break out of the loop after 20 iterations.

//If the script needs to break out because of too many iterations, your character has likely died due to their glaring incompetence. Please turn your character sheet over to the DM for processing.

//Thanks to Warklaw, Scott C, and The Aaron for their help in designing this script.

on('chat:message', function(mel) {

    var cmdNam;

    var msgtxt;



    cmdNam = '!MelFumb ';

    msgtxt = mel.content;

    if(mel.type == 'api' && msgtxt.indexOf(cmdNam) !== -1) {



            var missdif = msgtxt.slice(cmdNam.length);

            var selfinj = 1;

            var melfumbroll;

            var penalty = 0;

            var penaltydur = 0;

            var pen = 0;

            var pendur = 0;

            var pendur1 = 0;

            var count = 1;

            var error = 0;

            var OE="No free atttack";
            
            

            melfumbroll = randomInteger(1000)+(Number(missdif)*10);



            if (melfumbroll%2 == 1)

            {var OE="Defender gains a free attack!";}

            

            do

            {//log(melfumbroll);

            if (melfumbroll < 201)

            {sendChat("Fumble", "&{template:hm_std}{{name=Fumble Result}}{{Free Attack= "+ OE +"}}{{Fumble result == " + melfumbroll +"}}{{Effect= No special ill effect.}}");}

            else

            {if (melfumbroll < 217)

            {sendChat("Fumble", "&{template:hm_std}{{name=Fumble Result}}{{Free Attack= "+ OE +"}}{{Fumble result == " + melfumbroll +"}}{{Eeffect=Sweat in your eyes, -1 attack for 10 seconds.}}");}

            else

            {if (melfumbroll < 233)

            {sendChat("Fumble", "&{template:hm_std}{{name=Fumble Result}}{{Free Attack= "+ OE +"}}{{Fumble result == " + melfumbroll +"}}{{Effect=Blood in your eyes, -3 attack for 10 seconds.}}");}

            else

            {if (melfumbroll < 248)

            {sendChat("Fumble", "&{template:hm_std}{{name=Fumble Result}}{{Free Attack= "+ OE +"}}{{Fumble result == " + melfumbroll +"}}{{What Happened?=Random ally within reach+5' is automatically hit by their opponent and the ally's count resets.}}");}

            else

            {if (melfumbroll < 264)

            {penaltydur = randomInteger(4);

            pendur = penaltydur;

            while (pendur == 4)

            {pendur = randomInteger(4);

            penaltydur = penaltydur + pendur - 1;}

            sendChat("Fumble", "&{template:hm_std}{{name=Fumble Result}}{{Free Attack= "+ OE +"}}{{Fumble result == " + melfumbroll +"}}{{What Happened?= Distracted by ally or opponent}}{{ Effect = add " + penaltydur + " seconds wait time before next attack and -4 penalty to Defense whilst so distracted.}}");}

            else

            {if (melfumbroll < 277)

            {sendChat("Fumble", "&{template:hm_std}{{name=Fumble Result}}{{Free Attack= "+ OE +"}}{{Fumble result == " + melfumbroll +"}}{{What Happened?= Boot/footgear breaks}}{{Effect= -1 to attack and defense until repaired or discarded.}}");}

            else

            {if (melfumbroll < 319)

            {sendChat("Fumble", "&{template:hm_std}{{name=Fumble Result}}{{Free Attack= "+ OE +"}}{{Fumble result == " + melfumbroll +"}}}{{What Happened?= Backpack, pouch, or other container strap breaks}}{{Effect= -1 to attack and defense until item repaired or discarded.}}");}

            else

            {if (melfumbroll < 344)

            {sendChat("Fumble", "&{template:hm_std}{{name=Fumble Result}}{{Free Attack= "+ OE +"}}{{Fumble result == " + melfumbroll +"}}{{What Happened?= Belt, girdle, etc. breaks}}{{Effect= -1 to attack and defense until item repaired or discarded.}}");}

            else

            {if (melfumbroll < 365)

            {sendChat("Fumble", "&{template:hm_std}{{name=Fumble Result}}{{Free Attack= "+ OE +"}}{{Fumble result == " + melfumbroll +"}}{{What Happened?= Armor loosened }}{{Effect= -1 to attack and defense until readjusted (by redonning or by another person helping for 10 seconds).}}");}

            else

            {if (melfumbroll < 371)

            {sendChat("Fumble", "&{template:hm_std}{{name=Fumble Result}}{{Free Attack= "+ OE +"}}{{Fumble result == " + melfumbroll +"}}{{What Happened?= Armor strap breaks }}{{Effect= -2 to attack and defense until repaired.}}");}

            else

            {if (melfumbroll < 399)

            {sendChat("Fumble", "&{template:hm_std}{{name=Fumble Result}}{{Free Attack= "+ OE +"}}{{Fumble result == " + melfumbroll +"}}{{What Happened?= Shield strap breaks}}{{ Effect= -3 to attack and defense until repaired or discarded.}}");}

            else

            {if (melfumbroll < 437)

            {sendChat("Fumble", "&{template:hm_std}{{name=Fumble Result}}{{Free Attack= "+ OE +"}}{{Fumble result == " + melfumbroll +"}}{{What Happened?= Damage own armor (1 point).}}");}

            else

            {if (melfumbroll < 473)

            {sendChat("Fumble", "&{template:hm_std}{{name= Other Complications}}{{What Happened?= Weapon handle broken}}{{Effect=-1 attack penalty.}}");}

            else

            {if (melfumbroll < 509)

            {sendChat("Fumble", "&{template:hm_std}{{name=Fumble Result}}{{Free Attack= "+ OE +"}}{{Fumble result == " + melfumbroll +"}}{{What Happened?= Blade/head broken}}{{Effect=-1 to damage.}}");}

            else

            {if (melfumbroll < 518)

            {sendChat("Fumble", "&{template:hm_std}{{name=Fumble Result}}{{Free Attack= "+ OE +"}}{{Fumble result == " + melfumbroll +"}}{{What Happened?= Blade shattered (useless).}}");}

            else

            {if (melfumbroll < 527)

            {sendChat("Fumble", "&{template:hm_std}{{name=Fumble Result}}{{Free Attack= "+ OE +"}}{{Fumble result == " + melfumbroll +"}}{{What Happened?= Handle/haft sheared (useless).}}");}

            else

            {if (melfumbroll < 536)

            {sendChat("Fumble", "&{template:hm_std}{{name=Fumble Result}}{{Free Attack= "+ OE +"}}{{Fumble result == " + melfumbroll +"}}{{What Happened?= Sheared (useless).}}");}

            else

            {if (melfumbroll < 554)

            {sendChat("Fumble", "&{template:hm_std}{{name=Fumble Result}}{{Free Attack= "+ OE +"}}{{Fumble result == " + melfumbroll +"}}{{What Happened?= Handle badly broken}}{{Effect= -2 attack penalty.}}");}

            else

            {if (melfumbroll < 572)

            {sendChat("Fumble", "&{template:hm_std}{{name=Fumble Result}}{{Free Attack= "+ OE +"}}{{Fumble result == " + melfumbroll +"}}{{What Happened?= Blade/head badly broken}}{[Effect=  -25% damage.}}");}

            else

            {if (melfumbroll < 581)

            {sendChat("Fumble", "&{template:hm_std}{{name=Fumble Result}}{{Free Attack= "+ OE +"}}{{Fumble result == " + melfumbroll +"}}{{What Happened?= Blade/head sheared/cracked}}{{Effect= -50% to damage.}}");}

            else

            {if (melfumbroll < 617)

            {sendChat("Fumble", "&{template:hm_std}{{name=Fumble Result}}{{Free Attack= "+ OE +"}}{{Fumble result == " + melfumbroll +"}}{{What Happened?= Edge dulled, nicked, and/or cracked}}{{Effect= -1 to attack and damage.}}");}

            else

            {if (melfumbroll < 631)

            {penaltydur = randomInteger(4);

            sendChat("Fumble", "&{template:hm_std}{{name=Fumble Result}}{{Free Attack= "+ OE +"}}{{Fumble result == " + melfumbroll +"}}{{What Happened?= Overextend}}{{Effect= +" + penaltydur + " seconds penalty to next attack, -2 to next defense roll.}}");}

            else

            {if (melfumbroll < 645)

            {penalty = randomInteger(4) + 1;

            penaltydur = randomInteger(6);

            sendChat("Fumble", "&{template:hm_std}{{name=Fumble Result}}{{Free Attack= "+ OE +"}}{{Fumble result == " + melfumbroll +"}}{{What Happened?= Hinder a random ally within 5' + weapon reach.}}{{Effect= They suffer +" + penaltydur + " seconds penalty to next attack and a -" + penalty + " to hit penalty on next attack roll or 25% chance of hitting you instead. If the ally is a spellcaster in the midst of casting a spell this counts as 'Caster struck by blow absorbed by body armor' for spell mishaps.}}");}

            else

            {if (melfumbroll < 659)

            {penaltydur = randomInteger(4);

            sendChat("Fumble", "&{template:hm_std}{{name=Fumble Result}}{{Free Attack= "+ OE +"}}{{Fumble result == " + melfumbroll +"}}{{What Happened?= Off balance}}{{Effect= +" + penaltydur + " seconds to next attack.}}");}

            else

            {if (melfumbroll < 673)

            {sendChat("Fumble", "&{template:hm_std}{{name=Fumble Result}}{{Free Attack= "+ OE +"}}{{Fumble result == " + melfumbroll +"}}{{What Happened?= Overextend}}{{Effect= -2 to next defense roll.}}");}

            else

            {if (melfumbroll < 689)

            {penalty = randomInteger(20);

            pen = penalty;

            if (pen == 20)

            {while (pen > 5)

            {pen = randomInteger(6);

            penalty = penalty + pen - 1;}}

            penalty = penalty + 6;

            sendChat("Fumble", "&{template:hm_std}{{name=Fumble Result}}{{Free Attack= "+ OE +"}}{{Fumble result == " + melfumbroll +"}}{{What Happened?= Slip }}{{Effect= make a Feat of Agility check vs. " + penalty + " or fall prone and suffer a -6 to all defense and attack rolls for 10 seconds.}}");}

            else

            {if (melfumbroll < 691)

            {penalty = randomInteger(3);

            if (penalty == 1)

            {penaltydur = randomInteger(3);}

            else

            {if (penalty == 2)

            {penaltydur = randomInteger(3) + randomInteger(3);}

            else

            {if (penalty == 3)

            {penaltydur = randomInteger(3) + randomInteger(3) + randomInteger(3);}}}

            selfinj = randomInteger(6);

            if (selfinj == 6)

            {penaltydur = penaltydur * 1.5;

            sendChat("Fumble", "&{template:hm_std}{{name=Fumble Result}}{{Free Attack= "+ OE +"}}{{Fumble result == " + melfumbroll +"}}{{What Happened?= Muscle tear in left big toe }}{{Effect=  -" + penalty + " attack penalty and -50% movement. Injury heals over " + penaltydur + " weeks.}}");}

            else

            {sendChat("Fumble", "&{template:hm_std}{{name=Fumble Result}}{{Free Attack= "+ OE +"}}{{Fumble result == " + melfumbroll +"}}{{What Happened?= Left big toe is sprained/hyperextended }}{{Effect=  -" + penalty + " attack penalty and -50% movement. Injury heals over " + penaltydur + " weeks.}}");}}

            else

            {if (melfumbroll < 693)

            {penalty = randomInteger(3);

            if (penalty == 1)

            {penaltydur = randomInteger(3);}

            else

            {if (penalty == 2)

            {penaltydur = randomInteger(3) + randomInteger(3);}

            else

            {if (penalty == 3)

            {penaltydur = randomInteger(3) + randomInteger(3) + randomInteger(3);}}}

            selfinj = randomInteger(6);

            if (selfinj == 6)

            {penaltydur = penaltydur * 1.5;

            sendChat("Fumble", "&{template:hm_std}{{name=Fumble Result}}{{Free Attack= "+ OE +"}}{{Fumble result == " + melfumbroll +"}}{{What Happened?= Muscle tear in right big toe}}{{Effect= -" + penalty + " attack penalty and -50% movement. Injury heals over " + penaltydur + " weeks.}}");}

            else

            {sendChat("Fumble", "&{template:hm_std}{{name=Fumble Result}}{{Free Attack= "+ OE +"}}{{Fumble result == " + melfumbroll +"}}{{What Happened?= Right big toe is sprained/hyperextended}}{{Effect= -" + penalty + " attack penalty and -50% movement. Injury heals over " + penaltydur + " weeks.}}");}}

            else

            {if (melfumbroll < 695)

            {penalty = randomInteger(3);

            if (penalty == 1)

            {penaltydur = randomInteger(3);}

            else

            {if (penalty == 2)

            {penaltydur = randomInteger(3) + randomInteger(3);}

            else

            {if (penalty == 3)

            {penaltydur = randomInteger(3) + randomInteger(3) + randomInteger(3);}}}

            selfinj = randomInteger(6);

            if (selfinj == 6)

            {penaltydur = penaltydur * 1.5;

            sendChat("Fumble", "&{template:hm_std}{{name=Fumble Result}}{{Free Attack= "+ OE +"}}{{Fumble result == " + melfumbroll +"}}{{What Happened?= Muscle tear in left foot.}}{{Effect= -" + penalty + " attack penalty and -50% movement. Injury heals over " + penaltydur + " weeks.}}");}

            else

            {sendChat("Fumble", "&{template:hm_std}{{name=Fumble Result}}{{Free Attack= "+ OE +"}}{{Fumble result == " + melfumbroll +"}}{{What Happened?= Left foot is sprained/hyperextended.}}{[Effect= -" + penalty + " attack penalty and -50% movement. Injury heals over " + penaltydur + " weeks.}}");}}

            else

            {if (melfumbroll < 697)

            {penalty = randomInteger(3);

            if (penalty == 1)

            {penaltydur = randomInteger(3);}

            else

            {if (penalty == 2)

            {penaltydur = randomInteger(3) + randomInteger(3);}

            else

            {if (penalty == 3)

            {penaltydur = randomInteger(3) + randomInteger(3) + randomInteger(3);}}}

            selfinj = randomInteger(6);

            if (selfinj == 6)

            {penaltydur = penaltydur * 1.5;

            sendChat("Fumble", "&{template:hm_std}{{name=Fumble Result}}{{Free Attack= "+ OE +"}}{{Fumble result == " + melfumbroll +"}}{{What Happened?= Muscle tear in right foot}}{{Effect= -" + penalty + " attack penalty and -50% movement. Injury heals over " + penaltydur + " weeks.}}");}

            else

            {sendChat("Fumble", "&{template:hm_std}{{name=Fumble Result}}{{Free Attack= "+ OE +"}}{{Fumble result == " + melfumbroll +"}}{{What Happened?= Right foot is sprained/hyperextended.}}{{Effect= -" + penalty + " attack penalty and -50% movement. Injury heals over " + penaltydur + " weeks.}}");}}

            else

            {if (melfumbroll < 699)

            {penalty = randomInteger(3);

            if (penalty == 1)

            {penaltydur = randomInteger(3);}

            else

            {if (penalty == 2)

            {penaltydur = randomInteger(3) + randomInteger(3);}

            else

            {if (penalty == 3)

            {penaltydur = randomInteger(3) + randomInteger(3) + randomInteger(3);}}}

            selfinj = randomInteger(6);

            if (selfinj == 6)

            {penaltydur = penaltydur * 1.5;

            sendChat("Fumble", "&{template:hm_std}{{name=Fumble Result}}{{Free Attack= "+ OE +"}}{{Fumble result == " + melfumbroll +"}}{{What Happened?= Muscle tear in right ankle.}}{{Effect= -" + penalty + " attack penalty and -50% movement. Injury heals over " + penaltydur + " weeks.}}");}

            else

            {sendChat("Fumble", "&{template:hm_std}{{name=Fumble Result}}{{Free Attack= "+ OE +"}}{{Fumble result == " + melfumbroll +"}}{{What Happened?= Right ankle is sprained/hyperextended.}}{{Effect= -" + penalty + " attack penalty and -50% movement. Injury heals over " + penaltydur + " weeks.}}");}}

            else

            {if (melfumbroll < 701)

            {penalty = randomInteger(3);

            if (penalty == 1)

            {penaltydur = randomInteger(3);}

            else

            {if (penalty == 2)

            {penaltydur = randomInteger(3) + randomInteger(3);}

            else

            {if (penalty == 3)

            {penaltydur = randomInteger(3) + randomInteger(3) + randomInteger(3);}}}

            selfinj = randomInteger(6);

            if (selfinj == 6)

            {penaltydur = penaltydur * 1.5;

            sendChat("Fumble", "&{template:hm_std}{{name=Fumble Result}}{{Free Attack= "+ OE +"}}{{Fumble result == " + melfumbroll +"}}{{What Happened?= Muscle tear in left ankle.}}{{Effect= -" + penalty + " attack penalty and -50% movement. Injury heals over " + penaltydur + " weeks.}}");}

            else

            {sendChat("Fumble", "&{template:hm_std}{{name=Fumble Result}}{{Free Attack= "+ OE +"}}{{Fumble result == " + melfumbroll +"}}{{What Happened?= Left ankle is sprained/hyperextended.}}{{Effect= -" + penalty + " attack penalty and -50% movement. Injury heals over " + penaltydur + " weeks.}}");}}

            else

            {if (melfumbroll < 703)

            {penalty = randomInteger(3);

            if (penalty == 1)

            {penaltydur = randomInteger(3);}

            else

            {if (penalty == 2)

            {penaltydur = randomInteger(3) + randomInteger(3);}

            else

            {if (penalty == 3)

            {penaltydur = randomInteger(3) + randomInteger(3) + randomInteger(3);}}}

            selfinj = randomInteger(6);

            if (selfinj == 6)

            {penaltydur = penaltydur * 1.5;

            sendChat("Fumble", "&{template:hm_std}{{name=Fumble Result}}{{Free Attack= "+ OE +"}}{{Fumble result == " + melfumbroll +"}}{{What Happened?= Muscle tear in right knee.}}{{Effect= -" + penalty + " attack penalty and -50% movement. Injury heals over " + penaltydur + " weeks.}}");}

            else

            {sendChat("Fumble", "&{template:hm_std}{{name=Fumble Result}}{{Free Attack= "+ OE +"}}{{Fumble result == " + melfumbroll +"}}{{What Happened?= Right knee is sprained/hyperextended.}}{{Effect= -" + penalty + " attack penalty and -50% movement. Injury heals over " + penaltydur + " weeks.}}");}}

            else

            {if (melfumbroll < 705)

            {penalty = randomInteger(3);

            if (penalty == 1)

            {penaltydur = randomInteger(3);}

            else

            {if (penalty == 2)

            {penaltydur = randomInteger(3) + randomInteger(3);}

            else

            {if (penalty == 3)

            {penaltydur = randomInteger(3) + randomInteger(3) + randomInteger(3);}}}

            selfinj = randomInteger(6);

            if (selfinj == 6)

            {penaltydur = penaltydur * 1.5;

            sendChat("Fumble", "&{template:hm_std}{{name=Fumble Result}}{{Free Attack= "+ OE +"}}{{Fumble result == " + melfumbroll +"}}{{What Happened?= Muscle tear in left knee.}}{{Effect= -" + penalty + " attack penalty and -50% movement. Injury heals over " + penaltydur + " weeks.}}");}

            else

            {sendChat("Fumble", "&{template:hm_std}{{name=Fumble Result}}{{Free Attack= "+ OE +"}}{{Fumble result == " + melfumbroll +"}}{{What Happened?= Left knee is sprained/hyperextended.}}{{Effect= -" + penalty + " attack penalty and -50% movement. Injury heals over " + penaltydur + " weeks.}}");}}

            else

            {if (melfumbroll < 707)

            {penalty = randomInteger(3);

            if (penalty == 1)

            {penaltydur = randomInteger(3);}

            else

            {if (penalty == 2)

            {penaltydur = randomInteger(3) + randomInteger(3);}

            else

            {if (penalty == 3)

            {penaltydur = randomInteger(3) + randomInteger(3) + randomInteger(3);}}}

            selfinj = randomInteger(6);

            if (selfinj == 6)

            {penaltydur = penaltydur * 1.5;

            sendChat("Fumble", "&{template:hm_std}{{name=Fumble Result}}{{Free Attack= "+ OE +"}}{{Fumble result == " + melfumbroll +"}}{{What Happened?= Muscle tear in right hip.}}{{Effect= -" + penalty + " attack penalty and -50% movement. Injury heals over " + penaltydur + " weeks.}}");}

            else

            {sendChat("Fumble", "&{template:hm_std}{{name=Fumble Result}}{{Free Attack= "+ OE +"}}{{Fumble result == " + melfumbroll +"}}{{What Happened?= Right hip is sprained/hyperextended.}}{{Effect= -" + penalty + " attack penalty and -50% movement. Injury heals over " + penaltydur + " weeks.}}");}}

            else

            {if (melfumbroll < 709)

            {penalty = randomInteger(3);

            if (penalty == 1)

            {penaltydur = randomInteger(3);}

            else

            {if (penalty == 2)

            {penaltydur = randomInteger(3) + randomInteger(3);}

            else

            {if (penalty == 3)

            {penaltydur = randomInteger(3) + randomInteger(3) + randomInteger(3);}}}

            selfinj = randomInteger(6);

            if (selfinj == 6)

            {penaltydur = penaltydur * 1.5;

            sendChat("Fumble", "&{template:hm_std}{{name=Fumble Result}}{{Free Attack= "+ OE +"}}{{Fumble result == " + melfumbroll +"}}{{What Happened?= Muscle tear in left hip.}]{{Effect= -" + penalty + " attack penalty and -50% movement. Injury heals over " + penaltydur + " weeks.}}");}

            else

            {sendChat("Fumble", "&{template:hm_std}{{name=Fumble Result}}{{Free Attack= "+ OE +"}}{{Fumble result == " + melfumbroll +"}}{{What Happened?= Left hip is sprained/hyperextended.}}{{Effect= -" + penalty + " attack penalty and -50% movement. Injury heals over }}" + penaltydur + " weeks.");}}

            else

            {if (melfumbroll < 711)

            {penalty = randomInteger(3);

            if (penalty == 1)

            {penaltydur = randomInteger(3);}

            else

            {if (penalty == 2)

            {penaltydur = randomInteger(3) + randomInteger(3);}

            else

            {if (penalty == 3)

            {penaltydur = randomInteger(3) + randomInteger(3) + randomInteger(3);}}}

            selfinj = randomInteger(6);

            if (selfinj == 6)

            {penaltydur = penaltydur * 1.5;

            sendChat("Fumble", "&{template:hm_std}{{name=Fumble Result}}{{Free Attack= "+ OE +"}}{{Fumble result == " + melfumbroll +"}}{{What Happened?= Muscle tear in right wrist.}}{{Effect= -" + penalty + " attack penalty. Injury heals over " + penaltydur + " weeks.}}");}

            else

            {sendChat("Fumble", "&{template:hm_std}{{name=Fumble Result}}{{Free Attack= "+ OE +"}}{{Fumble result == " + melfumbroll +"}}{{What Happened?=Right wrist is sprained/hyperextended.}}{{Effect= -" + penalty + " attack penalty. Injury heals over " + penaltydur + " weeks.}}");}}

            else

            {if (melfumbroll < 713)

            {penalty = randomInteger(3);

            if (penalty == 1)

            {penaltydur = randomInteger(3);}

            else

            {if (penalty == 2)

            {penaltydur = randomInteger(3) + randomInteger(3);}

            else

            {if (penalty == 3)

            {penaltydur = randomInteger(3) + randomInteger(3) + randomInteger(3);}}}

            selfinj = randomInteger(6);

            if (selfinj == 6)

            {penaltydur = penaltydur * 1.5;

            sendChat("Fumble", "&{template:hm_std}{{name=Fumble Result}}{{Free Attack= "+ OE +"}}{{Fumble result == " + melfumbroll +"}}{{What Happened?= Muscle tear in left wrist.}}{{Effect= -" + penalty + " attack penalty. Injury heals over " + penaltydur + " weeks.}}");}

            else

            {sendChat("Fumble", "&{template:hm_std}{{name=Fumble Result}}{{Free Attack= "+ OE +"}}{{Fumble result == " + melfumbroll +"}}{{What Happened?= Left wrist is sprained/hyperextended.}}{{Effect= -" + penalty + " attack penalty. Injury heals over " + penaltydur + " weeks.}}");}}

            else

            {if (melfumbroll < 715)

            {penalty = randomInteger(3);

            if (penalty == 1)

            {penaltydur = randomInteger(3);}

            else

            {if (penalty == 2)

            {penaltydur = randomInteger(3) + randomInteger(3);}

            else

            {if (penalty == 3)

            {penaltydur = randomInteger(3) + randomInteger(3) + randomInteger(3);}}}

            selfinj = randomInteger(6);

            if (selfinj == 6)

            {penaltydur = penaltydur * 1.5;

            sendChat("Fumble", "&{template:hm_std}{{name=Fumble Result}}{{Free Attack= "+ OE +"}}{{Fumble result == " + melfumbroll +"}}{{What Happened?= Muscle tear in right shoulder.}}{{Effect=-" + penalty + " attack penalty. Injury heals over " + penaltydur + " weeks.}}");}

            else

            {sendChat("Fumble", "&{template:hm_std}{{name=Fumble Result}}{{Free Attack= "+ OE +"}}{{Fumble result == " + melfumbroll +"}}{{What Happened?= Right shoulder is sprained/hyperextended.}}{{Effect= -" + penalty + " attack penalty. Injury heals over " + penaltydur + " weeks.}}");}}

            else

            {if (melfumbroll < 717)

            {penalty = randomInteger(3);

            if (penalty == 1)

            {penaltydur = randomInteger(3);}

            else

            {if (penalty == 2)

            {penaltydur = randomInteger(3) + randomInteger(3);}

            else

            {if (penalty == 3)

            {penaltydur = randomInteger(3) + randomInteger(3) + randomInteger(3);}}}

            selfinj = randomInteger(6);

            if (selfinj == 6)

            {penaltydur = penaltydur * 1.5;

            sendChat("Fumble", "&{template:hm_std}{{name=Fumble Result}}{{Free Attack= "+ OE +"}}{{Fumble result == " + melfumbroll +"}}{{What Happened?= Muscle tear in left shoulder.}}{{Effect= -" + penalty + " attack penalty. Injury heals over " + penaltydur + " weeks.}}");}

            else

            {sendChat("Fumble", "&{template:hm_std}{{name=Fumble Result}}{{Free Attack= "+ OE +"}}{{Fumble result == " + melfumbroll +"}}{{What Happened?= Left shoulder is sprained/hyperextended.}}{[Effect= -" + penalty + " attack penalty. Injury heals over " + penaltydur + " weeks.}}");}}

            else

            {if (melfumbroll < 719)

            {penalty = randomInteger(3);

            if (penalty == 1)

            {penaltydur = randomInteger(3);}

            else

            {if (penalty == 2)

            {penaltydur = randomInteger(3) + randomInteger(3);}

            else

            {if (penalty == 3)

            {penaltydur = randomInteger(3) + randomInteger(3) + randomInteger(3);}}}

            selfinj = randomInteger(6);

            if (selfinj == 6)

            {penaltydur = penaltydur * 1.5;

            sendChat("Fumble", "&{template:hm_std}{{name=Fumble Result}}{{Free Attack= "+ OE +"}}{{Fumble result == " + melfumbroll +"}}{{What Happened?= Muscle tear in right elbow.}}{{Effect= -" + penalty + " attack penalty. Injury heals over " + penaltydur + " weeks.}}");}

            else

            {sendChat("Fumble", "&{template:hm_std}{{name=Fumble Result}}{{Free Attack= "+ OE +"}}{{Fumble result == " + melfumbroll +"}}{{What Happened?= Right elbow is sprained/hyperextended.}}{{Effect= -" + penalty + " attack penalty. Injury heals over " + penaltydur + " weeks.}}");}}

            else

            {if (melfumbroll < 721)

            {penalty = randomInteger(3);

            if (penalty == 1)

            {penaltydur = randomInteger(3);}

            else

            {if (penalty == 2)

            {penaltydur = randomInteger(3) + randomInteger(3);}

            else

            {if (penalty == 3)

            {penaltydur = randomInteger(3) + randomInteger(3) + randomInteger(3);}}}

            selfinj = randomInteger(6);

            if (selfinj == 6)

            {penaltydur = penaltydur * 1.5;

            sendChat("Fumble", "&{template:hm_std}{{name=Fumble Result}}{{Free Attack= "+ OE +"}}{{Fumble result == " + melfumbroll +"}}{{What Happened?= Muscle tear in left elbow.}}{{Effect= -" + penalty + " attack penalty. Injury heals over " + penaltydur + " weeks.}}");}

            else

            {sendChat("Fumble", "&{template:hm_std}{{name=Fumble Result}}{{Free Attack= "+ OE +"}}{{Fumble result == " + melfumbroll +"}}{{What Happened?= Left elbow is sprained/hyperextended.}}{{Effect= -" + penalty + " attack penalty. Injury heals over " + penaltydur + " weeks.}}");}}

            else

            {if (melfumbroll < 723)

            {penalty = randomInteger(3);

            if (penalty == 1)

            {penaltydur = randomInteger(3);}

            else

            {if (penalty == 2)

            {penaltydur = randomInteger(3) + randomInteger(3);}

            else

            {if (penalty == 3)

            {penaltydur = randomInteger(3) + randomInteger(3) + randomInteger(3);}}}

            selfinj = randomInteger(6);

            if (selfinj == 6)

            {penaltydur = penaltydur * 1.5;

            sendChat("Fumble", "&{template:hm_std}{{name=Fumble Result}}{{Free Attack= "+ OE +"}}{{Fumble result == " + melfumbroll +"}}{{What Happened?= Muscle tear in neck.}}{{Effect= -" + penalty + " attack penalty. Injury heals over " + penaltydur + " weeks.}}");}

            else

            {sendChat("Fumble", "&{template:hm_std}{{name=Fumble Result}}{{Free Attack= "+ OE +"}}{{Fumble result == " + melfumbroll +"}}{{What Happened?= Neck is sprained/hyperextended.}}{{Effect= -" + penalty + " attack penalty. Injury heals over " + penaltydur + " weeks.}}");}}

            else

            {if (melfumbroll < 725)

            {penalty = randomInteger(3);

            if (penalty == 1)

            {penaltydur = randomInteger(3);}

            else

            {if (penalty == 2)

            {penaltydur = randomInteger(3) + randomInteger(3);}

            else

            {if (penalty == 3)

            {penaltydur = randomInteger(3) + randomInteger(3) + randomInteger(3);}}}

            selfinj = randomInteger(6);

            if (selfinj == 6)

            {penaltydur = penaltydur * 1.5;

            sendChat("Fumble", "&{template:hm_std}{{name=Fumble Result}}{{Free Attack= "+ OE +"}}{{Fumble result == " + melfumbroll +"}}{{What Happened?= Muscle tear in back.}}{{Effect= -" + penalty + " attack penalty. Injury heals over " + penaltydur + " weeks.}}");}

            else

            {sendChat("Fumble", "&{template:hm_std}{{name=Fumble Result}}{{Free Attack= "+ OE +"}}{{Fumble result == " + melfumbroll +"}}{{What Happened?= Back is sprained/hyperextended.}}{{Effect= -" + penalty + " attack penalty. Injury heals over " + penaltydur + " weeks.}}");}}

            else

            {if (melfumbroll < 727)

            {penalty = randomInteger(3);

            if (penalty == 1)

            {penaltydur = randomInteger(3);}

            else

            {if (penalty == 2)

            {penaltydur = randomInteger(3) + randomInteger(3);}

            else

            {if (penalty == 3)

            {penaltydur = randomInteger(3) + randomInteger(3) + randomInteger(3);}}}

            selfinj = randomInteger(6);

            if (selfinj == 6)

            {penaltydur = penaltydur * 1.5;

            sendChat("Fumble", "&{template:hm_std}{{name=Fumble Result}}{{Free Attack= "+ OE +"}}{{Fumble result == " + melfumbroll +"}}{{What Happened?= Muscle tear in left achilles.}}{{Effect= -" + penalty + " attack penalty and -50% movement. Injury heals over " + penaltydur + " weeks.}}");}

            else

            {sendChat("Fumble", "&{template:hm_std}{{name=Fumble Result}}{{Free Attack= "+ OE +"}}{{Fumble result == " + melfumbroll +"}}{{What Happened?= Left achilles is sprained/hyperextended.}}{{effect= -" + penalty + " attack penalty and -50% movement. Injury heals over " + penaltydur + " weeks.}}");}}

            else

            {if (melfumbroll < 729)

            {penalty = randomInteger(3);

            if (penalty == 1)

            {penaltydur = randomInteger(3);}

            else

            {if (penalty == 2)

            {penaltydur = randomInteger(3) + randomInteger(3);}

            else

            {if (penalty == 3)

            {penaltydur = randomInteger(3) + randomInteger(3) + randomInteger(3);}}}

            selfinj = randomInteger(6);

            if (selfinj == 6)

            {penaltydur = penaltydur * 1.5;

            sendChat("Fumble", "&{template:hm_std}{{name=Fumble Result}}{{Free Attack= "+ OE +"}}{{Fumble result == " + melfumbroll +"}}{{What Happened?= Muscle tear in right achilles.}}{{Effect= -" + penalty + " attack penalty and -50% movement. Injury heals over " + penaltydur + " weeks.}}");}

            else

            {sendChat("Fumble", "&{template:hm_std}{{name=Fumble Result}}{{Free Attack= "+ OE +"}}{{Fumble result == " + melfumbroll +"}}{{What Happened?= Right achilles is sprained/hyperextended.}}{{Effect= -" + penalty + " attack penalty and -50% movement. Injury heals over " + penaltydur + " weeks.}}");}}

            else

            {if (melfumbroll < 731)

            {penalty = randomInteger(4);

            pen = penalty;

            while (pen == 4)

            {pen = randomInteger(4);

            penalty = penalty + pen - 1;}

            pen = penalty;

            penaltydur = 0;

            selfinj = randomInteger(6);

            if (selfinj == 6)

            {while (pen > 0)

            {pendur = randomInteger(3);

            pendur1 = pendur;

            while (pendur == 3)

            {pendur = randomInteger(3);

            pendur1 = pendur1 + pendur - 1;}

            penaltydur = penaltydur + pendur1;

            pen = pen - 0.5;}

            sendChat("Fumble", "&{template:hm_std}{{name=Fumble Result}}{{Free Attack= "+ OE +"}}{{Fumble result == " + melfumbroll +"}}{{What Happened?= Torn ligament in left calf.}}{{Effect= -" + penalty + " attack penalty and -50% movement. Injury heals over " + penaltydur + " weeks, but half the penalty is permanent.}}");}

            else

            {while (pen > 0)

            {pendur = randomInteger(3);

            penaltydur = penaltydur + pendur;

            pen = pen - 1;}

            sendChat("Fumble", "&{template:hm_std}{{name=Fumble Result}}{{Free Attack= "+ OE +"}}{{Fumble result == " + melfumbroll +"}}{{What Happened?= Muscle in left calf is strained/pulled.}}{{Effect= -" + penalty + " attack penalty and -50% movement. Injury heals over " + penaltydur + " weeks.}}");}}

            else

            {if (melfumbroll < 733)

            {penalty = randomInteger(4);

            pen = penalty;

            while (pen == 4)

            {pen = randomInteger(4);

            penalty = penalty + pen - 1;}

            pen = penalty;

            penaltydur = 0;

            selfinj = randomInteger(6);

            if (selfinj == 6)

            {while (pen > 0)

            {pendur = randomInteger(3);

            pendur1 = pendur;

            while (pendur == 3)

            {pendur = randomInteger(3);

            pendur1 = pendur1 + pendur - 1;}

            penaltydur = penaltydur + pendur1;

            pen = pen - 0.5;}

            sendChat("Fumble", "&{template:hm_std}{{name=Fumble Result}}{{Free Attack= "+ OE +"}}{{Fumble result == " + melfumbroll +"}}{{What Happened?= Torn ligament in right calf.}}{{Effect= -" + penalty + " attack penalty and -50% movement. Injury heals over " + penaltydur + " weeks, but half the penalty is permanent.}}");}

            else

            {while (pen > 0)

            {pendur = randomInteger(3);

            penaltydur = penaltydur + pendur;

            pen = pen - 1;}

            sendChat("Fumble", "&{template:hm_std}{{name=Fumble Result}}{{Free Attack= "+ OE +"}}{{Fumble result == " + melfumbroll +"}}{{What Happened?= Muscle in right calf is strained/pulled.}}{{Effect= -" + penalty + " attack penalty and -50% movement. Injury heals over " + penaltydur + " weeks.}}");}}

            else

            {if (melfumbroll < 736)

            {penalty = randomInteger(4);

            pen = penalty;

            while (pen == 4)

            {pen = randomInteger(4);

            penalty = penalty + pen - 1;}

            pen = penalty;

            penaltydur = 0;

            selfinj = randomInteger(6);

            if (selfinj == 6)

            {while (pen > 0)

            {pendur = randomInteger(3);

            pendur1 = pendur;

            while (pendur == 3)

            {pendur = randomInteger(3);

            pendur1 = pendur1 + pendur - 1;}

            penaltydur = penaltydur + pendur1;

            pen = pen - 0.5;}

            sendChat("Fumble", "&{template:hm_std}{{name=Fumble Result}}{{Free Attack= "+ OE +"}}{{Fumble result == " + melfumbroll +"}}{{What Happened?= Torn ligament in left hamstring.}}{{Effect= -" + penalty + " attack penalty and -50% movement. Injury heals over " + penaltydur + " weeks, but half the penalty is permanent.}}");}

            else

            {while (pen > 0)

            {pendur = randomInteger(3);

            penaltydur = penaltydur + pendur;

            pen = pen - 1;}

            sendChat("Fumble", "&{template:hm_std}{{name=Fumble Result}}{{Free Attack= "+ OE +"}}{{Fumble result == " + melfumbroll +"}}{{What Happened?= Muscle in left hamstring is strained/pulled.}}{{Effect= -" + penalty + " attack penalty and -50% movement. Injury heals over " + penaltydur + " weeks.}}");}}

            else

            {if (melfumbroll < 739)

            {penalty = randomInteger(4);

            pen = penalty;

            while (pen == 4)

            {pen = randomInteger(4);

            penalty = penalty + pen - 1;}

            pen = penalty;

            penaltydur = 0;

            selfinj = randomInteger(6);

            if (selfinj == 6)

            {while (pen > 0)

            {pendur = randomInteger(3);

            pendur1 = pendur;

            while (pendur == 3)

            {pendur = randomInteger(3);

            pendur1 = pendur1 + pendur - 1;}

            penaltydur = penaltydur + pendur1;

            pen = pen - 0.5;}

            sendChat("Fumble", "&{template:hm_std}{{name=Fumble Result}}{{Free Attack= "+ OE +"}}{{Fumble result == " + melfumbroll +"}}{{What Happened?= Torn ligament in right hamstring.}}{{Effect= -" + penalty + " attack penalty and -50% movement. Injury heals over " + penaltydur + " weeks, but half the penalty is permanent.}}");}

            else

            {while (pen > 0)

            {pendur = randomInteger(3);

            penaltydur = penaltydur + pendur;

            pen = pen - 1;}

            sendChat("Fumble", "&{template:hm_std}{{name=Fumble Result}}{{Free Attack= "+ OE +"}}{{Fumble result == " + melfumbroll +"}}{{What Happened?= Muscle in right hamstring is strained/pulled.}}{{Effect= -" + penalty + " attack penalty and -50% movement. Injury heals over " + penaltydur + " weeks.}}");}}

            else

            {if (melfumbroll < 741)

            {penalty = randomInteger(4);

            pen = penalty;

            while (pen == 4)

            {pen = randomInteger(4);

            penalty = penalty + pen - 1;}

            pen = penalty;

            penaltydur = 0;

            selfinj = randomInteger(6);

            if (selfinj == 6)

            {while (pen > 0)

            {pendur = randomInteger(3);

            pendur1 = pendur;

            while (pendur == 3)

            {pendur = randomInteger(3);

            pendur1 = pendur1 + pendur - 1;}

            penaltydur = penaltydur + pendur1;

            pen = pen - 0.5;}

            sendChat("Fumble", "&{template:hm_std}{{name=Fumble Result}}{{Free Attack= "+ OE +"}}{{Fumble result == " + melfumbroll +"}}{{What Happened?= Torn ligament in left quadriceps.}}{{Effect= -" + penalty + " attack penalty and -50% movement. Injury heals over " + penaltydur + " weeks, but half the penalty is permanent.}}");}

            else

            {while (pen > 0)

            {pendur = randomInteger(3);

            penaltydur = penaltydur + pendur;

            pen = pen - 1;}

            sendChat("Fumble", "&{template:hm_std}{{name=Fumble Result}}{{Free Attack= "+ OE +"}}{{Fumble result == " + melfumbroll +"}}{{What Happened?= Muscle in left quadriceps is strained/pulled.}}{{Effect= -" + penalty + " attack penalty and -50% movement. Injury heals over " + penaltydur + " weeks.}}");}}

            else

            {if (melfumbroll < 743)

            {penalty = randomInteger(4);

            pen = penalty;

            while (pen == 4)

            {pen = randomInteger(4);

            penalty = penalty + pen - 1;}

            pen = penalty;

            penaltydur = 0;

            selfinj = randomInteger(6);

            if (selfinj == 6)

            {while (pen > 0)

            {pendur = randomInteger(3);

            pendur1 = pendur;

            while (pendur == 3)

            {pendur = randomInteger(3);

            pendur1 = pendur1 + pendur - 1;}

            penaltydur = penaltydur + pendur1;

            pen = pen - 0.5;}

            sendChat("Fumble", "&{template:hm_std}{{name=Fumble Result}}{{Free Attack= "+ OE +"}}{{Fumble result == " + melfumbroll +"}}{{What Happened?= Torn ligament in right quadriceps.}}{{Effect= -" + penalty + " attack penalty and -50% movement. Injury heals over " + penaltydur + " weeks, but half the penalty is permanent.}}");}

            else

            {while (pen > 0)

            {pendur = randomInteger(3);

            penaltydur = penaltydur + pendur;

            pen = pen - 1;}

            sendChat("Fumble", "&{template:hm_std}{{name=Fumble Result}}{{Free Attack= "+ OE +"}}{{Fumble result == " + melfumbroll +"}}{{What Happened?= Muscle in right quadriceps is strained/pulled.}}{{Effect= -" + penalty + " attack penalty and -50% movement. Injury heals over " + penaltydur + " weeks.}}");}}

            else

            {if (melfumbroll < 745)

            {penalty = randomInteger(4);

            pen = penalty;

            while (pen == 4)

            {pen = randomInteger(4);

            penalty = penalty + pen - 1;}

            pen = penalty;

            penaltydur = 0;

            selfinj = randomInteger(6);

            if (selfinj == 6)

            {while (pen > 0)

            {pendur = randomInteger(3);

            pendur1 = pendur;

            while (pendur == 3)

            {pendur = randomInteger(3);

            pendur1 = pendur1 + pendur - 1;}

            penaltydur = penaltydur + pendur1;

            pen = pen - 0.5;}

            sendChat("Fumble", "&{template:hm_std}{{name=Fumble Result}}{{Free Attack= "+ OE +"}}{{Fumble result == " + melfumbroll +"}}{{What Happened?= Torn ligament in gluteus maximus.}}{{Effect=-" + penalty + " attack penalty and -50% movement. Injury heals over " + penaltydur + " weeks, but half the penalty is permanent.}}");}

            else

            {while (pen > 0)

            {pendur = randomInteger(3);

            penaltydur = penaltydur + pendur;

            pen = pen - 1;}

            sendChat("Fumble", "&{template:hm_std}{{name=Fumble Result}}{{Free Attack= "+ OE +"}}{{Fumble result == " + melfumbroll +"}}{{What Happened?= Muscle in gluteus maximus is strained/pulled.}}{{Effect= -" + penalty + " attack penalty and -50% movement. Injury heals over " + penaltydur + " weeks.}}");}}

            else

            {if (melfumbroll < 747)

            {penalty = randomInteger(4);

            pen = penalty;

            while (pen == 4)

            {pen = randomInteger(4);

            penalty = penalty + pen - 1;}

            pen = penalty;

            penaltydur = 0;

            selfinj = randomInteger(6);

            if (selfinj == 6)

            {while (pen > 0)

            {pendur = randomInteger(3);

            pendur1 = pendur;

            while (pendur == 3)

            {pendur = randomInteger(3);

            pendur1 = pendur1 + pendur - 1;}

            penaltydur = penaltydur + pendur1;

            pen = pen - 0.5;}

            sendChat("Fumble", "&{template:hm_std}{{name=Fumble Result}}{{Free Attack= "+ OE +"}}{{Fumble result == " + melfumbroll +"}}{{What Happened?= Torn ligament in forearm.}}{{Effect= -" + penalty + " attack penalty. Injury heals over " + penaltydur + " weeks, but half the penalty is permanent.}}");}

            else

            {while (pen > 0)

            {pendur = randomInteger(3);

            penaltydur = penaltydur + pendur;

            pen = pen - 1;}

            sendChat("Fumble", "&{template:hm_std}{{name=Fumble Result}}{{Free Attack= "+ OE +"}}{{Fumble result == " + melfumbroll +"}}{{What Happened?= Muscle in forearm is strained/pulled.}}{{Effect= -" + penalty + " attack penalty. Injury heals over " + penaltydur + " weeks.}}");}}

            else

            {if (melfumbroll < 749)

            {penalty = randomInteger(4);

            pen = penalty;

            while (pen == 4)

            {pen = randomInteger(4);

            penalty = penalty + pen - 1;}

            pen = penalty;

            penaltydur = 0;

            selfinj = randomInteger(6);

            if (selfinj == 6)

            {while (pen > 0)

            {pendur = randomInteger(3);

            pendur1 = pendur;

            while (pendur == 3)

            {pendur = randomInteger(3);

            pendur1 = pendur1 + pendur - 1;}

            penaltydur = penaltydur + pendur1;

            pen = pen - 0.5;}

            sendChat("Fumble", "&{template:hm_std}{{name=Fumble Result}}{{Free Attack= "+ OE +"}}{{Fumble result == " + melfumbroll +"}}{{What Happened?= Torn ligament in bicep.}}{{Effect= -" + penalty + " attack penalty. Injury heals over " + penaltydur + " weeks, but half the penalty is permanent.}}");}

            else

            {while (pen > 0)

            {pendur = randomInteger(3);

            penaltydur = penaltydur + pendur;

            pen = pen - 1;}

            sendChat("Fumble", "&{template:hm_std}{{name=Fumble Result}}{{Free Attack= "+ OE +"}}{{Fumble result == " + melfumbroll +"}}{{What Happened?= Muscle in bicep is strained/pulled.}}{{Effect= -" + penalty + " attack penalty. Injury heals over " + penaltydur + " weeks.}}");}}

            else

            {if (melfumbroll < 752)

            {penalty = randomInteger(4);

            pen = penalty;

            while (pen == 4)

            {pen = randomInteger(4);

            penalty = penalty + pen - 1;}

            pen = penalty;

            penaltydur = 0;

            selfinj = randomInteger(6);

            if (selfinj == 6)

            {while (pen > 0)

            {pendur = randomInteger(3);

            pendur1 = pendur;

            while (pendur == 3)

            {pendur = randomInteger(3);

            pendur1 = pendur1 + pendur - 1;}

            penaltydur = penaltydur + pendur1;

            pen = pen - 0.5;}

            sendChat("Fumble", "&{template:hm_std}{{name=Fumble Result}}{{Free Attack= "+ OE +"}}{{Fumble result == " + melfumbroll +"}}{{What Happened?= Torn ligament in tricep.}}{{Effect= -" + penalty + " attack penalty. Injury heals over " + penaltydur + " weeks, but half the penalty is permanent.}}");}

            else

            {while (pen > 0)

            {pendur = randomInteger(3);

            penaltydur = penaltydur + pendur;

            pen = pen - 1;}

            sendChat("Fumble", "&{template:hm_std}{{name=Fumble Result}}{{Free Attack= "+ OE +"}}{{Fumble result == " + melfumbroll +"}}{{What Happened?= Muscle in tricep is strained/pulled.}}{{Effect= -" + penalty + " attack penalty. Injury heals over " + penaltydur + " weeks.}}");}}

            else

            {if (melfumbroll < 760)

            {penalty = randomInteger(4);

            pen = penalty;

            while (pen == 4)

            {pen = randomInteger(4);

            penalty = penalty + pen - 1;}

            pen = penalty;

            penaltydur = 0;

            selfinj = randomInteger(6);

            if (selfinj == 6)

            {while (pen > 0)

            {pendur = randomInteger(3);

            pendur1 = pendur;

            while (pendur == 3)

            {pendur = randomInteger(3);

            pendur1 = pendur1 + pendur - 1;}

            penaltydur = penaltydur + pendur1;

            pen = pen - 0.5;}

            sendChat("Fumble", "&{template:hm_std}{{name=Fumble Result}}{{Free Attack= "+ OE +"}}{{Fumble result == " + melfumbroll +"}}{{What Happened?= Torn ligament in lower back.}}{{Effect= -" + penalty + " attack penalty. Injury heals over " + penaltydur + " weeks, but half the penalty is permanent.}}");}

            else

            {while (pen > 0)

            {pendur = randomInteger(3);

            penaltydur = penaltydur + pendur;

            pen = pen - 1;}

            sendChat("Fumble", "&{template:hm_std}{{name=Fumble Result}}{{Free Attack= "+ OE +"}}{{Fumble result == " + melfumbroll +"}}{{What Happened?= Muscle in lower back is strained/pulled.}}{{Effect= -" + penalty + " attack penalty. Injury heals over " + penaltydur + " weeks.}}");}}

            else

            {if (melfumbroll < 762)

            {penalty = randomInteger(4);

            pen = penalty;

            while (pen == 4)

            {pen = randomInteger(4);

            penalty = penalty + pen - 1;}

            pen = penalty;

            penaltydur = 0;

            selfinj = randomInteger(6);

            if (selfinj == 6)

            {while (pen > 0)

            {pendur = randomInteger(3);

            pendur1 = pendur;

            while (pendur == 3)

            {pendur = randomInteger(3);

            pendur1 = pendur1 + pendur - 1;}

            penaltydur = penaltydur + pendur1;

            pen = pen - 0.5;}

            sendChat("Fumble", "&{template:hm_std}{{name=Fumble Result}}{{Free Attack= "+ OE +"}}{{Fumble result == " + melfumbroll +"}}{{What Happened?= Torn ligament in side.}}{{Effect= " + penalty + " attack penalty. Injury heals over " + penaltydur + " weeks, but half the penalty is permanent.}}");}

            else

            {while (pen > 0)

            {pendur = randomInteger(3);

            penaltydur = penaltydur + pendur;

            pen = pen - 1;}

            sendChat("Fumble", "&{template:hm_std}{{name=Fumble Result}}{{Free Attack= "+ OE +"}}{{Fumble result == " + melfumbroll +"}}{{What Happened?= Muscle in side is strained/pulled.}}{{Effect= -" + penalty + " attack penalty. Injury heals over " + penaltydur + " weeks.}}");}}

            else

            {if (melfumbroll < 767)

            {penalty = randomInteger(4);

            pen = penalty;

            while (pen == 4)

            {pen = randomInteger(4);

            penalty = penalty + pen - 1;}

            pen = penalty;

            penaltydur = 0;

            selfinj = randomInteger(6);

            if (selfinj == 6)

            {while (pen > 0)

            {pendur = randomInteger(3);

            pendur1 = pendur;

            while (pendur == 3)

            {pendur = randomInteger(3);

            pendur1 = pendur1 + pendur - 1;}

            penaltydur = penaltydur + pendur1;

            pen = pen - 0.5;}

            sendChat("Fumble", "&{template:hm_std}{{name=Fumble Result}}{{Free Attack= "+ OE +"}}{{Fumble result == " + melfumbroll +"}}{{What Happened?= Torn ligament in upper back.}}{{Effect= -" + penalty + " attack penalty. Injury heals over " + penaltydur + " weeks, but half the penalty is permanent.}}");}

            else

            {while (pen > 0)

            {pendur = randomInteger(3);

            penaltydur = penaltydur + pendur;

            pen = pen - 1;}

            sendChat("Fumble", "&{template:hm_std}{{name=Fumble Result}}{{Free Attack= "+ OE +"}}{{Fumble result == " + melfumbroll +"}}{{What Happened?= Muscle in upper back is strained/pulled.}}{{Effect= -" + penalty + " attack penalty. Injury heals over " + penaltydur + " weeks.}}");}}

            else

            {if (melfumbroll < 769)

            {penalty = randomInteger(4);

            pen = penalty;

            while (pen == 4)

            {pen = randomInteger(4);

            penalty = penalty + pen - 1;}

            pen = penalty;

            penaltydur = 0;

            selfinj = randomInteger(6);

            if (selfinj == 6)

            {while (pen > 0)

            {pendur = randomInteger(3);

            pendur1 = pendur;

            while (pendur == 3)

            {pendur = randomInteger(3);

            pendur1 = pendur1 + pendur - 1;}

            penaltydur = penaltydur + pendur1;

            pen = pen - 0.5;}

            sendChat("Fumble", "&{template:hm_std}{{name=Fumble Result}}{{Free Attack= "+ OE +"}}{{Fumble result == " + melfumbroll +"}}{{What Happened?= Torn ligament in left shoulder. -" + penalty + " attack penalty. Injury heals over " + penaltydur + " weeks, but half the penalty is permanent.}}");}

            else

            {while (pen > 0)

            {pendur = randomInteger(3);

            penaltydur = penaltydur + pendur;

            pen = pen - 1;}

            sendChat("Fumble", "&{template:hm_std}{{name=Fumble Result}}{{Free Attack= "+ OE +"}}{{Fumble result == " + melfumbroll +"}}{{What Happened?= Muscle in left shoulder is strained/pulled.}}{{Effect= -" + penalty + " attack penalty. Injury heals over " + penaltydur + " weeks.}}");}}

            else

            {if (melfumbroll < 771)

            {penalty = randomInteger(4);

            pen = penalty;

            while (pen == 4)

            {pen = randomInteger(4);

            penalty = penalty + pen - 1;}

            pen = penalty;

            penaltydur = 0;

            selfinj = randomInteger(6);

            if (selfinj == 6)

            {while (pen > 0)

            {pendur = randomInteger(3);

            pendur1 = pendur;

            while (pendur == 3)

            {pendur = randomInteger(3);

            pendur1 = pendur1 + pendur - 1;}

            penaltydur = penaltydur + pendur1;

            pen = pen - 0.5;}

            sendChat("Fumble", "&{template:hm_std}{{name=Fumble Result}}{{Free Attack= "+ OE +"}}{{Fumble result == " + melfumbroll +"}}{{What Happened?= Torn ligament in right shoulder.}}{{Effect= -" + penalty + " attack penalty. Injury heals over " + penaltydur + " weeks, but half the penalty is permanent.}}");}

            else

            {while (pen > 0)

            {pendur = randomInteger(3);

            penaltydur = penaltydur + pendur;

            pen = pen - 1;}

            sendChat("Fumble", "&{template:hm_std}{{name=Fumble Result}}{{Free Attack= "+ OE +"}}{{Fumble result == " + melfumbroll +"}}{{What Happened?= Muscle in right shoulder is strained/pulled.}}{{Effect= -" + penalty + " attack penalty. Injury heals over " + penaltydur + " weeks.}}");}}

            else

            {if (melfumbroll < 772)

            {penalty = randomInteger(4);

            pen = penalty;

            while (pen == 4)

            {pen = randomInteger(4);

            penalty = penalty + pen - 1;}

            pen = penalty;

            penaltydur = 0;

            selfinj = randomInteger(6);

            if (selfinj == 6)

            {while (pen > 0)

            {pendur = randomInteger(3);

            pendur1 = pendur;

            while (pendur == 3)

            {pendur = randomInteger(3);

            pendur1 = pendur1 + pendur - 1;}

            penaltydur = penaltydur + pendur1;

            pen = pen - 0.5;}

            sendChat("Fumble", "&{template:hm_std}{{name=Fumble Result}}{{Free Attack= "+ OE +"}}{{Fumble result == " + melfumbroll +"}}{{What Happened?= Torn ligament in neck.}}{{Effect= -" + penalty + " attack penalty. Injury heals over " + penaltydur + " weeks, but half the penalty is permanent.}}");}

            else

            {while (pen > 0)

            {pendur = randomInteger(3);

            penaltydur = penaltydur + pendur;

            pen = pen - 1;}

            sendChat("Fumble", "&{template:hm_std}{{name=Fumble Result}}{{Free Attack= "+ OE +"}}{{Fumble result == " + melfumbroll +"}}{{What Happened?= Muscle in neck is strained/pulled.}}{{Effect= -" + penalty + " attack penalty. Injury heals over " + penaltydur + " weeks.}}");}}

            else

            {if (melfumbroll < 774)

            {penalty = randomInteger(4);

            pen = penalty;

            while (pen == 4)

            {pen = randomInteger(4);

            penalty = penalty + pen - 1;}

            pen = penalty;

            penaltydur = 0;

            selfinj = randomInteger(6);

            if (selfinj == 6)

            {while (pen > 0)

            {pendur = randomInteger(3);

            pendur1 = pendur;

            while (pendur == 3)

            {pendur = randomInteger(3);

            pendur1 = pendur1 + pendur - 1;}

            penaltydur = penaltydur + pendur1;

            pen = pen - 0.5;}

            sendChat("Fumble", "&{template:hm_std}{{name=Fumble Result}}{{Free Attack= "+ OE +"}}{{Fumble result == " + melfumbroll +"}}{{What Happened?= Torn ligament in hip.}}{{Effect= -" + penalty + " attack penalty and -50% movement. Injury heals over " + penaltydur + " weeks, but half the penalty is permanent.}}");}

            else

            {while (pen > 0)

            {pendur = randomInteger(3);

            penaltydur = penaltydur + pendur;

            pen = pen - 1;}

            sendChat("Fumble", "&{template:hm_std}{{name=Fumble Result}}{{Free Attack= "+ OE +"}}{{Fumble result == " + melfumbroll +"}}{{What Happened?= Muscle in hip is strained/pulled.}}{{Effect= -" + penalty + " attack penalty and -50% movement. Injury heals over " + penaltydur + " weeks.}}");}}

            else

            {if (melfumbroll < 775)

            {penalty = randomInteger(4);

            pen = penalty;

            while (pen == 4)

            {pen = randomInteger(4);

            penalty = penalty + pen - 1;}

            pen = penalty;

            penaltydur = 0;

            selfinj = randomInteger(6);

            if (selfinj == 6)

            {while (pen > 0)

            {pendur = randomInteger(3);

            pendur1 = pendur;

            while (pendur == 3)

            {pendur = randomInteger(3);

            pendur1 = pendur1 + pendur - 1;}

            penaltydur = penaltydur + pendur1;

            pen = pen - 0.5;}

            sendChat("Fumble", "&{template:hm_std}{{name=Fumble Result}}{{Free Attack= "+ OE +"}}{{Fumble result == " + melfumbroll +"}}{{What Happened?= Torn ligament in abs.}}{{Effect= -" + penalty + " attack penalty. Injury heals over " + penaltydur + " weeks, but half the penalty is permanent.}}");}

            else

            {while (pen > 0)

            {pendur = randomInteger(3);

            penaltydur = penaltydur + pendur;

            pen = pen - 1;}

            sendChat("Fumble", "&{template:hm_std}{{name=Fumble Result}}{{Free Attack= "+ OE +"}}{{Fumble result == " + melfumbroll +"}}{{What Happened?= Muscle in abs is strained/pulled.}}{{Effect= -" + penalty + " attack penalty. Injury heals over " + penaltydur + " weeks.}}");}}

            else

            {if (melfumbroll < 865)

            {penalty = randomInteger(20);

            pen = penalty;

            if (pen == 20)

            {while (pen > 5)

            {pen = randomInteger(6);

            penalty = penalty + pen - 1;}}

            sendChat("Fumble", "&{template:hm_std}{{name=Fumble Result}}{{Free Attack= "+ OE +"}}{{Fumble result == " + melfumbroll +"}}{{What Happened?= Automatically inflict damage to a random ally within 5' + weapon reach.}}{{Effect= Roll damage dice and add strength bonus/penalty, but do not add bonuses from talents or specialization. Attempt a Feat of Agility check vs. " + penalty + " to deliver only half damage.}}");}

            else

            {if (melfumbroll < 942)

            {sendChat("Fumble", "&{template:hm_std}{{name=Fumble Result}}{{Free Attack= "+ OE +"}}{{Fumble result == " + melfumbroll +"}}{{What Happened?= Drop weapon at feet.}}");}

            else

            {if (melfumbroll < 965)

            {sendChat("Fumble", "&{template:hm_std}{{name=Fumble Result}}{{Free Attack= "+ OE +"}}{{Fumble result == " + melfumbroll +"}}{{What Happened?= Drop weapon 2 feet away.}}");}

            else

            {if (melfumbroll < 983)

            {sendChat("Fumble", "&{template:hm_std}{{name=Fumble Result}}{{Free Attack= "+ OE +"}}{{Fumble result == " + melfumbroll +"}}{{What Happened?= Drop weapon 3 feet away.}}");}

            else

            {if (melfumbroll < 996)

            {sendChat("Fumble", "&{template:hm_std}{{name=Fumble Result}}{{Free Attack= "+ OE +"}}{{Fumble result == " + melfumbroll +"}}{{What Happened?= Drop weapon 4 feet away.}}");}

            else

            {if (melfumbroll < 1005)

            {sendChat("Fumble", "&{template:hm_std}{{name=Fumble Result}}{{Free Attack= "+ OE +"}}{{Fumble result == " + melfumbroll +"}}{{What Happened?= Toss weapon 5 feet away.}}");}

            else

            {if (melfumbroll < 1011)

            {sendChat("Fumble", "&{template:hm_std}{{name=Fumble Result}}{{Free Attack= "+ OE +"}}{{Fumble result == " + melfumbroll +"}}{What Happened?= Toss weapon 6 feet away.}}");}

            else

            {if (melfumbroll < 1016)

            {sendChat("Fumble", "&{template:hm_std}{{name=Fumble Result}}{{Free Attack= "+ OE +"}}{{Fumble result == " + melfumbroll +"}}{{What Happened?= Toss weapon 7 feet away.}}");}

            else

            {if (melfumbroll < 1021)

            {sendChat("Fumble", "&{template:hm_std}{{name=Fumble Result}}{{Free Attack= "+ OE +"}}{{Fumble result == " + melfumbroll +"}}{{What Happened?= Toss weapon 8 feet away.}}");}

            else

            {if (melfumbroll < 1025)

            {sendChat("Fumble", "&{template:hm_std}{{name=Fumble Result}}{{Free Attack= "+ OE +"}}{{Fumble result == " + melfumbroll +"}}{{What Happened?= Toss weapon 9 feet away.}}");}

            else

            {if (melfumbroll < 1029)

            {sendChat("Fumble", "&{template:hm_std}{{name=Fumble Result}}{{Free Attack= "+ OE +"}}{{Fumble result == " + melfumbroll +"}}{{What Happened?= Throw weapon 10 feet away.}}");}

            else

            {if (melfumbroll < 1032)

            {sendChat("Fumble", "&{template:hm_std}{{name=Fumble Result}}{{Free Attack= "+ OE +"}}{{Fumble result == " + melfumbroll +"}}{{What Happened?= Throw weapon 11 feet away.}}");}

            else

            {if (melfumbroll < 1035)

            {sendChat("Fumble", "&{template:hm_std}{{name=Fumble Result}}{{Free Attack= "+ OE +"}}{{Fumble result == " + melfumbroll +"}}{{What Happened?= Throw weapon 12 feet away.}}");}

            else

            {if (melfumbroll < 1038)

            {sendChat("Fumble", "&{template:hm_std}{{name=Fumble Result}}{{Free Attack= "+ OE +"}}{{Fumble result == " + melfumbroll +"}}{{What Happened?= Throw weapon 13 feet away.}}");}

            else

            {if (melfumbroll < 1040)

            {sendChat("Fumble", "&{template:hm_std}{{name=Fumble Result}}{{Free Attack= "+ OE +"}}{{Fumble result == " + melfumbroll +"}}{{What Happened?= Throw weapon 14 feet away.}}");}

            else

            {if (melfumbroll < 1042)

            {sendChat("Fumble", "&{template:hm_std}{{name=Fumble Result}}{{Free Attack= "+ OE +"}}{{Fumble result == " + melfumbroll +"}}{{What Happened?= Hurl weapon 15 feet away.}}");}

            else

            {if (melfumbroll < 1044)

            {sendChat("Fumble", "&{template:hm_std}{{name=Fumble Result}}{{Free Attack= "+ OE +"}}{{Fumble result == " + melfumbroll +"}}{{What Happened?= Hurl weapon 16 feet away.}}");}

            else

            {if (melfumbroll < 1045)

            {penalty = randomInteger(4);

            pen = penalty;

            while (pen == 4)

            {pen = randomInteger(4);

            penalty = penalty + pen - 1;}

            penalty = penalty + 16;

            sendChat("Fumble", "&{template:hm_std}{{name=Fumble Result}}{{Free Attack= "+ OE +"}}{{Fumble result == " + melfumbroll +"}}{{What Happened?= Hurl weapon " + penalty + " feet away.}}");}

            else

            {if (melfumbroll < 1101)

            {penalty = randomInteger(20);

            pen = penalty;

            if (pen == 20)

            {while (pen > 5)

            {pen = randomInteger(6);

            penalty = penalty + pen - 1;}}

            sendChat("Fumble", "&{template:hm_std}{{name=Fumble Result}}{{Free Attack= "+ OE +"}}{{Fumble result == " + melfumbroll +"}}{{What Happened?= Clumsily incur self-inflicted wound.}}{{Effect= Roll damage dice and add strength bonus/penalty, but do not add bonuses from talents or specialization. Attempt a Feat of Agility check vs. " + penalty + " to sustain only half damage.}}");}

            else

            {if (melfumbroll < 1201)

            {count = count + 2;

            sendChat("Fumble", "&{template:hm_std}{{name= Terrible Luck!}}{{What Happened?= Double results!}}{{Effect= If identical results are obtained, then add the durations together.}}");

            //log("At roll 1 Count " + count);

            }

            else

            {count = count + 3;

            sendChat("Fumble", "&{template:hm_std}{{name= Horrendous Luck}}{{What Happened?= Triple results!}}{{Effect= If identical results are obtained, then add the durations together.}}");

            //log("At roll 2 Count " + count);

            }

            }}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}

        count = count - 1;

        error = error + 1;

        if (error > 19)

        {break;}

        melfumbroll = randomInteger(1000)+(Number(missdif)*10);

        //log("Count" + count);

        } while (count > 0)

        if (error > 19)

        {sendChat("Fumble", "You got too many additional results and the script might crash! You have " + count + " additional results left to roll. You can try using the script again or roll the results individually on your own.");

        sendChat("Fumble", "Or you could just accept your inevitable death. That's on you.");}

        return;};

});
